#!/bin/bash

echo " STAR MSR Register: C000_0081h"
echo ""
echo "  63               48 47               32 31                        0"
echo "  +------------------------------------------------------------------+"
echo "  | SYSRET CS and SS | SYSCALL CS and SS | 32 bit SYSCALL Target EIP |"
echo "  +------------------------------------------------------------------+"
echo ""
echo " SYSRET CS and SS Selectors—Bits 63:48. This field is used to specify both the CS and SS"
echo " selectors loaded into CS and SS during SYSRET. If SYSRET is returning to 32-bit mode"
echo " (either legacy or compatibility), this field is copied directly into the CS selector field. If"
echo " SYSRET is returning to 64-bit mode, the CS selector is set to this field + 16. SS.Sel is set to"
echo " this field + 8, regardless of the target mode. Because SYSRET always returns to CPL 3, the"
echo " RPL bits 49:48 should be initialized to 11b."
echo ""
echo " SYSCALL CS and SS Selectors—Bits 47:32. This field is used to specify both the CS and SS"
echo " selectors loaded into CS and SS during SYSCALL. This field is copied directly into CS.Sel."
echo " SS.Sel is set to this field + 8. Because SYSCALL always switches to CPL 0, the RPL bits"
echo " 33:32 should be initialized to 00b."
echo ""
echo " 32-bit SYSCALL Target EIP—Bits 31:0. This is the target EIP of the called procedure"
echo " The legacy STAR register is not expanded in long mode to provide a 64-bit target RIP address."
echo " Instead, long mode provides two new STAR registers—long STAR (LSTAR) and compatibility"
echo " STAR (CSTAR)—that hold a 64-bit target RIP."

echo ""
echo " LSTAR MSR Register: C000_0082h"
echo "  63               48 47               32 31                        0"
echo "  +------------------------------------------------------------------+"
echo "  |          Target RIP for 64-Bit-Mode Calling Software             |"
echo "  +------------------------------------------------------------------+"
echo ""
echo " CSTAR MSR Register: CSTAR C000_0083h"
echo "  63               48 47               32 31                        0"
echo "  +------------------------------------------------------------------+"
echo "  |        Target RIP for Compatibility-Mode Calling Software        |"
echo "  +------------------------------------------------------------------+"
echo ""
echo " LSTAR and CSTAR—The LSTAR register holds the target RIP of the called procedure in long"
echo " mode when the calling software is in 64-bit mode. The CSTAR register holds the target RIP of the"
echo " called procedure in long mode when the calling software is in compatibility mode. The WRMSR"
echo " instruction is used to load the target RIP into the LSTAR and CSTAR registers. If the RIP written"
echo " to either of the MSRs is not in canonical form, a #GP fault is generated on the WRMSR instruction."

echo ""
echo " SFMASK MSR Register: C000_0084h"
echo "  64                                                                0"
echo "  +------------------------------------------------------------------+"
echo "  |          Reserved, RAZ            |        SYSCALL Flag Mask     |"
echo "  +------------------------------------------------------------------+"
echo ""
echo " SFMASK—The SFMASK register is used to specify which RFLAGS bits are cleared during a"
echo " SYSCALL. In long mode, SFMASK is used to specify which RFLAGS bits are cleared when"
echo " SYSCALL is executed. If a bit in SFMASK is set to 1, the corresponding bit in RFLAGS is cleared"
echo " to 0. If a bit in SFMASK is cleared to 0, the corresponding RFLAGS bit is not modified."
